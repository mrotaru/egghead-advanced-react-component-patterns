<html>
  <style>
  .switch { width: 100px; height: 100px; }
  .on { background-color: green; }
  .off { background-color: red; }
  </style>
  <head>
    <script src="https://unpkg.com/react@16.0.0/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@16.0.0/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/babel-standalone@6.26.0/babel.js"></script>
    <script src="https://unpkg.com/prop-types@15.6.0/prop-types.js"></script>
  </head>
  <body>
    <div id='root'>
    </div>
    <script type="text/babel">

      const TOGGLE_CONTEXT = '__toggle__'

      const ToggleOn = ({children}, context) => context[TOGGLE_CONTEXT].on
        ? <p className='on'>{children}</p>
        : null
      ToggleOn.contextTypes = {
        [TOGGLE_CONTEXT]: PropTypes.object.isRequired,
      }

      const ToggleOff = ({children}, context) => context[TOGGLE_CONTEXT].on === false
        ? <p className='off'>{children}</p>
        : null
      ToggleOff.contextTypes = {
        [TOGGLE_CONTEXT]: PropTypes.object.isRequired,
      }

      const ToggleButton = ({children, ...props}, context) => {
        console.log(children, props, context)
        const { on, toggle } = context[TOGGLE_CONTEXT]
        return <Switch {...{ onClick: toggle, on, ...props }} />
      }
      ToggleButton.contextTypes = {
        [TOGGLE_CONTEXT]: PropTypes.object.isRequired,
      }

      class Toggle extends React.Component {
        static defaultProps = { onToggle: () => {} }
        static On = ToggleOn
        static Off = ToggleOff
        static Button = ToggleButton
        static childContextTypes = {
          [TOGGLE_CONTEXT]: PropTypes.object.isRequired,
        }
        getChildContext = () => ({
          [TOGGLE_CONTEXT]: {
            on: this.state.on,
            toggle: this.toggle,
          }
        })
        state = { on: false }
        toggle = () => this.setState(
          ({on}) => ({on: !on}),
          () => this.props.onToggle(this.state.on)
        )
        render = () => {
          return <div>{this.props.children}</div>
        }
      }

      const App = () => {
        return (
          <Toggle onToggle={() => { console.log('toggling') }} >
            <Toggle.Button />
            <Toggle.Off>OFF</Toggle.Off>
            <Toggle.On>ON</Toggle.On>
          </Toggle>
        )
      }

      const Switch = ({on, ...props}) =>
        <div className={`switch ${on ? 'on' : 'off'}`} {...props} />

      ReactDOM.render(<App />, document.getElementById('root'))
    </script>
  </body>
</html>
